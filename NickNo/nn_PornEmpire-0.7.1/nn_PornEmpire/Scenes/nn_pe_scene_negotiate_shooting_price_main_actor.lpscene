WHAT: none
WHERE: none
WHEN: 0 - 24
WHO: MainActor = getSpecific(PassedOn)
OTHER: none

    // get some settings
    debugModeEnabled = Player.getActorVar(pe_DebugModeEnabled)
    
    SceneStart()
    
    // Get the desired location, main location for this code: nn_pe_scene_organize_shooting.lpscene
    desiredShootingLocation = nnPE_NextShootingLocation.getGlobal()
    
    // <--- Copy & Paste start
    If desiredShootingLocation == 1 // home
        moveTo(Home)
    ElseIf desiredShootingLocation == 3
        moveTo(Home)
        setBackground3D(Modules/nn_PornEmpire/Rooms/nn_pe_office_1.lpworld)
    ElseIf desiredShootingLocation == 4
        sceneType = Player.getActorVar(pe_SceneEquipmentType)
        If sceneType == 2
            setBackground3D(Modules/nn_PornEmpire/Rooms/vim_Porn_Studio1.lpworld)
        ElseIf sceneType == 3
            setBackground3D(Modules/nn_PornEmpire/Rooms/vim_Porn_Studio2.lpworld)
        ElseIf sceneType == 4
            setBackground3D(Modules/nn_PornEmpire/Rooms/vim_Porn_Studio3.lpworld)
        EndIf
    ElseIf desiredShootingLocation >= 20 && desiredShootingLocation <= 29 // hotel
        If desiredShootingLocation == 21
            setBackground3D(Modules/nn_PornEmpire/Rooms/nn_pe_hotelroom_2.lpworld)
        ElseIf desiredShootingLocation == 22
            setBackground3D(Modules/nn_PornEmpire/Rooms/nn_pe_hotelroom_3.lpworld)
        ElseIf desiredShootingLocation == 23
            setBackground3D(Modules/nn_PornEmpire/Rooms/nn_pe_hotelroom_4.lpworld)
        ElseIf desiredShootingLocation == 24
            setBackground3D(Modules/nn_PornEmpire/Rooms/vim_pe_hotelroom_5.lpworld)
        Else
            setBackground3D(Modules/nn_PornEmpire/Rooms/nn_pe_hotelroom_1.lpworld)
        EndIf
    EndIf
    // <--- Copy & Paste end
    
    askingPrice = 0
    
    If Player.isNaked()
        Player.dress()
    EndIf
    Player.show()
    
    // Calculate salary for the shoot
    If MainActor.isValid()
        
        MainActor.dress()
        MainActor.show(1)
        MainActor.moveToPersonStand(Player, 50) // Walk close to the target
        
        isAgencyModel = MainActor.getActorVar(pe_IsAgencyModel)
        
        If MainActor.isProstitute()    // prostitutes get a lower salary
            askingPrice = 650
            MainActor.setActorVar(pe_EmployeeSalary, askingPrice)
            askingPriceLocal = askingPrice.convertToLocalCurrency(true)
            
            Player(Serene)::"<MainActor.Name> is one of my sex workers. I will pay <MainActor.o> <askingPriceLocal> for this shooting."
        
        ElseIf isAgencyModel > 0
            // Shooting price is based on attractiveness and pornfame
            askingPrice = 75 * MainActor:pornfame
            If MainActor:attractiveness > 50
                askingPrice = 100 * MainActor:pornfame
            ElseIf MainActor:attractiveness > 75
                askingPrice = 150 * MainActor:pornfame
            ElseIf MainActor:attractiveness > 90
                askingPrice = 200 * MainActor:pornfame
            EndIf
            
            // Price is higher than with normal npcs
            askingPrice *= 1.75  // real models are really expensive ;)
            
            askingPriceLocal = askingPrice.convertToLocalCurrency(true)
            "<MainActor.Name> is a PornAgency model and is available to book for <askingPriceLocal>. Book <MainActor.o>?"
            0:: "Yes, pay <askingPriceLocal>"
            1:: "Negotiate on the price"
            99:: "Don't book <MainActor.Name>"
            
            If 99
                MainActor.hide()
                MainActor = 0
            ElseIf 1
                AgencyBoss = generatePersonTemporary(nn_pe_AgencyBoss)
                dressFormal()
                AgencyBoss.dress()
                dressFormal()
                secondScreen(AgencyBoss)
                AgencyBoss.show(3)
                Random
                    AgencyBoss::"Listen buddy, you pay my price, or my models won't work for you. Easy as is uh?"
                    AgencyBoss::"If you want to do a shooting with one of my models, you will pay my price. Right?"
                    AgencyBoss::"Trying to negotiate with me? At least you have some balls... I like you!"
                    AgencyBoss::"Really? You want to pay less for <MainActor.Name>? Maybe you need to book someone else??"
                    AgencyBoss::"If you don't have money, then I don't have models. Understood?"
                EndRandom
                0:: "Pay what <AgencyBoss.Name> - <MainActor.Name>'s boss - demands"
                1:: "Don't do a shooting with <MainActor.Name>"
                
                If 1
                    MainActor = 0
                EndIf
                
                secondScreen()
                AgencyBoss.hide()
                AgencyBoss.delete()
            EndIf
        Else    // normal NPC
            
            // Test if the actor is one of my dates
            askForPrice = true
            
            // relative = MainActor.isRelative()
            // dating = MainActor.isDating()
            // mon = Player:Money
            // "Debug: relative=<relative>, dating=<dating>, money=<mon>"
            
            If money < 2000
                If MainActor.isDating() || MainActor.isRelative()
                    
                    Player(Embarassed)::"<MainActor.Name> is my <MainActor.relationship> and I am low on money. Should I ask <MainActor.o> to do the shoot for free?"
                    0:: "Yes it's worth a try."
                    1:: "No, I will pay <MainActor.o>."
                    
                    If 0 
                        If MainActor:rapportwithplayer >= 55
                            Random
                                MainActor(Wink):: "Listen honey, I will do that for you. But you owe me more than one now!"
                                MainActor(Wink):: "Good idea to earn some money this way. 50:50 - deal?!"
                                MainActor(Bored):: "<Player.Boy_or_Girl>, you got some real problems uh? Ok... I will do it for you."
                                MainActor(Bored):: "Oh poor <Player.boy_or_girl>, you are asking me to help you with my body? All right, but don't take this for granted!"
                            EndRandom
                            Player(Happy)::"Wow! I was lucky. <MainActor.Name> will do the shoot without being paid."
                            askForPrice = false
                        Else
                            Random
                                MainActor(Angry):: "<Player.Name> you will have to keep your money together! I'll model for you, but not for free!"
                                MainActor(Bored):: "<Player.Boy_or_Girl>, you can be happy if I do the shooting with you at all. But I want to see some cash!"
                                MainActor(Bored):: "I'm not going to undress if you are not going to pay. It's easy as that!"
                            EndRandom
                            Player(Sad)::"Uhh! Let's see how much <MainActor.s> is asking for..."
                        EndIf
                    EndIf
                EndIf
            EndIf
            
            If askForPrice
                
                If debugModeEnabled > 0
                    "Debug: Calculate askingPrice: intelligence=<MainActor:intelligence> attractiveness=<MainActor:attractiveness>"
                EndIf
                
                // Shooting price is based on attractiveness and intelligence
                askingPrice = 75 * MainActor:intelligence
                If MainActor:attractiveness > 50
                    askingPrice = 100 * MainActor:intelligence
                ElseIf MainActor:attractiveness > 75
                    askingPrice = 150 * MainActor:intelligence
                ElseIf MainActor:attractiveness > 90
                    askingPrice = 200 * MainActor:intelligence
                EndIf
                
                askingPriceLocal = askingPrice.convertToLocalCurrency(true)
                
                Random
                    Player(Bored)::"<MainActor.Name> is asking for <askingPriceLocal>. Will I pay that for <MainActor.o>?"
                    Player(Serene)::"<MainActor.Name> requests a salary of <askingPriceLocal>. Pay that?"
                    Player(Serene)::"<MainActor.Name> thinks <MainActor.s> is worth <askingPriceLocal>. Accept that?"
                    Player(Serene)::"<MainActor.Name> demands <askingPriceLocal> for taking part in this shooting. Accept?"
                    Player(Serene)::"<askingPriceLocal> is what <MainActor.Name> thinks I should pay <MainActor.o> for this shooting. Agree?"
                    Player(Serene)::"WOW! Holy shit. <MainActor.Name> is asking me to pay <MainActor.o> <askingPriceLocal> for this shooting. Agree?"
                    Player(Serene)::"What a diva! <MainActor.Name> asks <askingPriceLocal> for <MainActor.p> participation in this shooting. Let <MainActor.o> dream on?"
                EndRandom
                0:: "Yes, pay <askingPriceLocal>"
                1:: "Try to negotiate with <MainActor.Name>"
                99:: "Don't book <MainActor.Name>"
                
                If 1
                    chance = Random(1,5)
                    If chance >= 3
                        askingPrice -= (chance*100)
                        If askingPrice < 350
                            askingPrice = 350
                        EndIf
                        askingPriceLocal = askingPrice.convertToLocalCurrency(true)
                        Player(Wink)::"I was able to talk <MainActor.Name> down to <askingPriceLocal>."
                    Else
                        Random
                            Player(Annoyed)::"<MainActor.Name> was not willing to negotiate."
                            Player(Annoyed)::"I will have to pay what <MainActor.o> demands or find another model that I can afford."
                            Player(Annoyed)::"My negotiations were unlucky."
                            Player(Annoyed)::"Bah! <MainActor.Name> says this is <MainActor.p> minimum."
                            Player(Annoyed)::"<MainActor.Name> consisted on <MainActor.p> salary. I had no chance..."
                            Player(Annoyed)::"<MainActor.Name> withstood my inferior negotiation skills."
                            Player(Annoyed)::"I had a hard time negotiating with <MainActor.Name>. We could not agree on a discount."
                            Player(Annoyed)::"<MainActor.Name> refused to give me a discount. Hope that <MainActor.dick_or_bitch> is worth it!"
                            Player(Annoyed)::"This time I did not succeed in negotiating with <MainActor.Name>. Maybe next time?"
                        EndRandom
                        0:: "Pay what <MainActor.s> demands"
                        1:: "Don't do a shooting with <MainActor.o>"
                        
                        If 1
                            MainActor = 0
                        EndIf
                    EndIf
                ElseIf 99
                    MainActor.hide()
                    MainActor = 0
                EndIf
            EndIf
        EndIf
        
        askingPrice
    EndIf
    
    If money < askingPrice && MainActor.isValid()
        Player(Sad)::"I don't have enough money to pay <MainActor.Name>."
        Player(Curious)::"I need to find another way to make money!"
    ElseIf MainActor.isValid()
        nnPE_NextShootingCost.setGlobal(askingPrice)
        
        MainActor.passOn()
        followUp(nn_pe_scene_do_shooting_new)
    EndIf
    
    SceneEnd()
    